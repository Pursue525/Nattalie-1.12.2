package net.pursue.mode.exploit;

import net.minecraft.network.play.server.SPacketCustomPayload;
import net.pursue.mode.Mode;
import net.pursue.utils.Germ.GermManager;
import net.pursue.utils.Germ.Wrapper;
import net.pursue.utils.Germ.forge.ForgeChannel;
import net.pursue.utils.Germ.vexview.VexViewWrapper;
import net.pursue.utils.category.Category;

public class Protocol extends Mode {

    public static Protocol INSTANCE;

    public Protocol() {
        super("Protocol", "协议", "让你能够绕过服务器内的某些协议", Category.EXPLOIT);
        INSTANCE = this;
    }

    static GermManager germModPacket = new GermManager();

    private final VexViewWrapper vexViewWrapper = new VexViewWrapper();
    public ForgeChannel forgeChannel = new ForgeChannel();

    public void processPacket(SPacketCustomPayload packet) {
        if (packet.getChannelName().equalsIgnoreCase("FML|HS") || packet.getChannelName().equalsIgnoreCase("REGISTER") || packet.getChannelName().equalsIgnoreCase("UNREGISTER")) {
            this.forgeChannel.processForge(packet);
        } else if (packet.getChannelName().equalsIgnoreCase("germplugin-netease")) {
            Wrapper.runOnMainThread(() -> germModPacket.process(packet.getBufferData()));
        } else if (packet.getChannelName().equals("VexView")) {
            this.vexViewWrapper.processVewView(packet);
        }
    }
}
